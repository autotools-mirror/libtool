2008-02-29  Gary V. Vaughan  <gary@gnu.org>

	* libltdl/m4/argz.m4 (AC_CHECK_FUNCS): Also use our replacement
	argz if the system argz_add or argz_count are missing.
	Report by Juan Manuel Guerrero <juan.guerrero@gmx.de>.

2008-02-26  Karl Berry  <karl@freefriends.org>

	* libltdl/argz.c (argz_add, argz_count): New functions.
	* libltdl/argz_.h: Declare them.
	Report by Juan Manuel Guerrero <juan.guerrero@gmx.de>.

2008-02-20  Peter O'Gorman  <peter@pogma.com>

	* libltdl/m4/libtool.m4 (_LT_LANG_GCJ_CONFIG): Do not call the
	_LT_SYS_DYNAMIC_LINKER macro here.
	Reported by Mike Frysinger <vapier@gentoo.org>

2008-02-15  Peter O'Gorman  <peter@pogma.com>

	* libltdl/m4/libtool.m4 (_LT_SYS_HIDDEN_LIBDEPS): Fix typo.

2008-02-14  Peter Breitenlohner  <peb@mppmu.mpg.de>

	* libltdl/m4/libtool.m4 (_LT_SYS_DYNAMIC_LINKER): better handling
	of predefined values for lt_cv_sys_lib_search_path_spec and
	lt_cv_sys_lib_dlsearch_path_spec.

2008-02-14  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* libtoolize.m4sh (func_install_pkgconfig_files): Only call
	func_install_pkgconfig_parent if $seen_autoconf.
	* tests/standalone.at (compiling softlinked libltdl)
	(compiling copied libltdl, installable libltdl)
	(linking libltdl without autotools): Use checked libtoolize
	calls to catch warnings.

2008-02-13  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* libltdl/configure.ac: Bump package version.
	* HACKING: Reminder to do it next time, too.

2008-02-11  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* tests/mdemo/Makefile.am (@LIBLTDL@): Update outdated
	dependencies.
	($(top_distdir)/libltdl/libtool): Remove.
	Fixes spurious mdemo-dryrun failure with OpenBSD make.

2008-02-09  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* libltdl/m4/libtool.m4 (_LT_COMPILER_PIC) [linux] <ifort>:
	Treat like icc and ecc, for fixed `-Wl,' and `-KPIC' settings.

2008-02-08  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* tests/archive-in-archive.at
	(static library contains static library): Test also the actual
	broken link command, and the following install command, as
	UnixWare ar rightly refuses to put an archive into an archive.
	Report by Tim Rice.

2008-02-06  Peter O'Gorman  <peter@pogma.com>

	* libltdl/m4/ltoptions.m4 (_LT_SET_OPTIONS): Only set default
	LT_INIT values for LT_INIT, not LTDL_INIT.
	Reported by Jochem Huhmann <joh@revier.com> 

2008-02-01  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* tests/testsuite.at (LT_AT_TAG): For the CXX tag, if $CXX is
	g++, check that `g++ -v' works; AC_PROG_CXX may have set that
	as default value even if it found no C++ compiler.
	Report by Andreas Schwab.

2008-02-02  Gary V. Vaughan  <gary@gnu.org>

	* libltdl/Makefile.inc (EXTRA_DIST): Now that we're not using
	Autoconf's AC_SOURCES macro, Automake can't trace our extra
	source files argz, lt__dirent.c and lt__strl.c.  List them
	manually here to make sure they are distributed.
	* NEWS: Updated.
	Reported by Bob Friesenhahn  <bfriesen@simple.dallas.tx.us>

2008-02-01  Gary V. Vaughan  <gary@gnu.org>

	* configure.ac (AC_INIT): Bump version number to 2.1c.

	GNU Libtool 2.1b was released.

	* configure.ac (AC_INIT): Bump version number to 2.1b.
	* libltdl/Makefile.inc (LTDL_VERSION_INFO): Increment to account
	for new interfaces since the last libltdl update.
	* HACKING (Release Procedure): Note that LTDL_VERSION_INFO is now
	kept in libltdl/Makefile.inc.

2008-02-01  Gary V. Vaughan  <gary@gnu.org>

	* tests/cdemo, tests/depdemo, tests/fcdemo, tests/pdemo,
	tests/demo, tests/f77demo, tests/mdemo, tests/tagdemo
	(distclean-local): Remove compiler file droppings left by
	Autoconf tests that prevent make dist from finishing on
	several machines including Mac OS 10.5.

2008-02-01  Gary V. Vaughan  <gary@gnu.org>

	Unfortunately, the autoconf implementation of AC_LIBOBJ and
	friends requires all libobjs to be in the same directory, as
	declared by AC_CONFIG_LIBOBJ_DIR.  That might prevent using
	either recursive or nonrecursive libltdl if the parent project
	has libobjs of its own, except that this patch tracks libltdl's
	libobjs in another namespace:

	* libltdl/m4/ltdl.m4 (_LT_LIBOBJ, _LT_LIBSOURCES): Versions of
	AC_LIBOBJ and AC_LIBSOURCES that save missing sources in a
	ltdl_LIBOBJS automake macro, instead of the global LIBOBJS
	automake macro.  Content of the macros inspired by code from
	gnulib-tool.
	(_LTDL_MODE_DISPATCH): Initialise lt_libobj_prefix in
	nonrecursive mode.
	(LTDL_INIT): Push and pop the new definitions around potential
	sites that call AC_LIBOBJ.  Also, using lt_libobj_prefix,
	initialise ltdl_LIBOBJS and ltdl_LTLIBOBJS.
	* libtoolize.m4sh (func_fixup_Makefile): Substitute ltdl_LIBOBJS
	and ltdl_LTLIBOBJS for LIBOBJS and LTLIBOBJS during copying
	either Makefile.am or Makefile.inc, depending on ltdl_mode.
	Reported by Eric Blake <ebb9@byu.net>

2008-01-30  Gary V. Vaughan  <gary@gnu.org>

	There are 5 distinct batches of files that libtoolize might
	install into a project, depending on whether libltdl is
	being installed in subproject mode, and in that case whether
	the parent project shares the config and macro directories
	with the subproject ltdl.  Make a separate function for each
	of those 5 batches (4 new functions below, plus the recently
	factored func_install_pkgltdl_files), and make a clearer
	distinction between when each of them is needed:

	* libtoolize.m4sh (func_install_pkgmacro_subproject):
	New function for installing and reporting on m4 files copied
	to a subproject ltdl directory.
	(func_install_pkgmacro_parent): Similar new function for m4
	files copied solely for the use of the parent project,
	including serial checking.
	(func_install_pkgconfig_subproject): New function for
	installing and reporting on config helper files copied to a
	subproject ltdl directory.
	(func_install_pkgconfig_parent): Similar new function for
	config helper files copied solely for the use of the parent
	project, including serial checking.
	(func_install_pkgmacro_files, func_install_pkgconfig_files):
	Rewritten in terms of the above functions.
	* tests/libtoolize.at: Adjust test expout's to match newly
	regularized libtoolize output.
	Move parent project pkgconfig files to build-aux directory
	so that progress messages show an obvious difference to
	pkgconfig files installed to subproject `config' directory.
	(nonrecursive ltdl with AC_CONFIG_MACRO_DIR): New test.
	(diagnose missing LT_CONFIG_LTDL_DIR): New test.
	(subproject ltdl with non-shared directories): New test.
	Reported by Eric Blake <ebb9@byu.net>

2008-01-29  Peter O'Gorman  <peter@pogma.com>

	* libltdl/m4/libtool.m4 [darwin]: Changes to glob pattern matching
	to be safer.

	Search the compiler path too.
	* libltdl/m4/libtool.m4 (compiler_lib_search_dirs): New variable.
	* libltdl/config/ltmain.m4sh: Use it.
	Reported by Maynard Johnson

2008-01-28  Gary V. Vaughan  <gary@gnu.org>

	* libtoolize.m4sh (func_check_macros): Correct typo with
	'$opt_quiet ||' where '$opt_quiet &&' that was preventing
	func_check_macros from running!

	* libtoolize.m4sh: Set opt_ltdl whenever seen_ltdl is set
	so that libtoolize behaves as though --ltdl was passed even
	if it wasn't as long as LTDL_INIT (or equivalent) was seen
	in configure.ac.  Adjust redundant '$opt_ltdl || $seen_ltdl'
	to simply '$opt_ltdl'.
	Reported by Eric Blake <ebb9@byu.net>

	* libtoolize.m4sh (func_check_macros): Check opt_quiet
	in the function itself to simplify calling it.  Also move
	the definition of the function.

	* libtoolize.m4sh (func_scan_files): Be sure to set the
	default libltdl mode to 'subproject' when libtoolize is
	executed before configure.ac has been updated.

2008-01-27  Gary V. Vaughan  <gary@gnu.org>

	* libtoolize.m4sh (func_install_pkgconfig_files)
	(func_install_pkgmacro_files, func_install_pkgltdl_files):
	Factored out from the 'Main' section of the file.

	* libtoolize.m4sh (subproject_auxdir, subproject_macrodir):
	New variables to hold the default locations for auxfiles
	and macrofiles in a subproject libltdl.
	(ac_auxdir, ac_macrodir): New variables to hold the values
	passed by AC_CONFIG_AUX_DIR and AC_CONFIG_MACRO_DIR resp.
	(auxdir, macrodir): Adjust to contain the values to be
	used by libtoolize at runtime.

	* libtoolize.m4sh (func_fixup_Makefile)
	(func_massage_aclocal_DATA, func_massage_pkgltdl_files)
	(func_massage_pkgconfig_files): Add missing $opt_debug.

2008-01-27  Gary V. Vaughan  <gary@gnu.org>

	* libtoolize (func_fixup_Makefile, func_massage_aclocal_DATA)
	(func_massage_pkgltdl_files, func_massage_pkgconfig_files):
	Add missing $opt_debug.

2008-01-26  Gary V. Vaughan  <gary@gnu.org>

	* libtoolize.m4sh (Main): Copy (or link) libltdl sources
	into project tree when LTDL_INIT was seen, whether or not
	`--ltdl' is passed.
	(func_check_macros): Recommend LTDL_INIT instead of
	LT_WITH_LTDL when `--ltdl' is used before configure.ac is
	upgraded.
	* tests/libtoolize.at: Test that it works.
	(_LT_AT_LTDL_SETUP): Factor out some common test setup.
	Reported by Eric Blake <ebb9@byu.net>

2008-01-24  Peter O'Gorman  <peter@pogma.com>

	* doc/notes.texi: Fix errors in previous commit.

	* libltdl/m4/libtool.m4 (sys_lib_search_path_spec, 
	sys_lib_dlsearch_path_spec): Allow for a cache variable 
	lt_cv_sys_lib_... to set these at configure time.
	* doc/notes.texi: Short note about the above change.

2008-01-24  Eric Blake  <ebb9@byu.net>

	Add proper quoting to doc examples.
	* doc/libtool.texi: Use m4 quotes where appropriate.
	(Test descriptions): Fix truncated sentence.

2008-01-18  Gary V. Vaughan  <gary@gnu.org>

	* Makefile.am (DISTCLEANFILES): Remove libtool.dvi generated
	by 'make dvi'.

2008-01-17  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* libtoolize.m4sh (func_scan_files): Avoid matching our own
	macro code when scanning configure.ac and aclocal.m4.
	Don't produce spurious output if AC_PROG_RANLIB is found.
	* tests/old-m4-iface.at (AM_PROG_LIBTOOL): Add a (weak) check
	that we don't match our own macro code when searching for user
	code calling us.
	* TODO: Updated.

2008-01-17  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	New variable LTDLDEPS for use in output_DEPENDENCIES.

	* libltdl/m4/ltdl.m4 (_LTDL_CONVENIENCE, _LTDL_INSTALLABLE)
	(LTDL_INIT): Set and substitute LTDLDEPS according to chosen
	method.
	* tests/configure-iface.at (installable libltdl)
	(--with-ltdl-include/lib, --with-included-ltdl): Test it.
	* doc/libtool.texi (Distributing libltdl): Document LTDLDEPS.
	* NEWS: Updated.
	Dependency bug exposed by Eric Blake in M4, found by Bob Proulx
	build daemon.

2008-01-17  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* doc/libtool.texi (Distributing libltdl): Clarify that
	`${top_build_prefix}' may be used in place of `${top_builddir}/'.

	* doc/libtool.texi (Distributing libltdl): Clarify that
	LTDL_INIT goes after LT_INIT; also show the latter in the
	respective examples.
	* tests/subproject.at: Adjust order.

2008-01-16  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* libltdl/m4/ltdl.m4 (_LT_ENABLE_INSTALL): Use AM_CONDITIONAL
	only if defined.  Allows to use libltdl without aclocal.

2008-01-16  Peter O'Gorman  <peter@pogma.com>

	* libltdl/m4/libtool.m4: Set GCC var for every tag, avoids need
	to set withGCC var.

2008-01-15  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* configure.ac: Set libltdl nonrecursive option, to avoid
	configuring libltdl inside the Libtool package.

2008-01-14  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Silence all non-warning output from `libtool --silent'.
	* libltdl/config/ltmain.m4sh (func_generate_dlsyms)
	(func_extract_archives, func_mode_link): Use func_verbose
	instead of func_echo for all non-warning output.

	* Makefile.maint (fetch): Update to match upstream git sources.
	Pull `INSTALL' from gnulib instead of from Autoconf.

	* doc/notes.texi: Mention AIX binutils deficiency for C++ code.
	Report by Rainer Tammer.
	Suggest using bash for configure.

	* libltdl/m4/ltoptions.m4 (AC_ENABLE_SHARED): Fix to use
	new _LT_SET_OPTION semantics.

2008-01-12  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* libltdl/m4/ltdl.m4 (_LTDL_SETUP): Define
	LTDL_DLOPEN_SELF_WORKS, depending upon lt_cv_dlopen_self.
	* libltdl/loaders/dlopen.c (vm_open) [!LTDL_DLOPEN_SELF_WORKS]:
	Fail for dlopen(NULL), so that the preopen loader is used.  This
	fixes mdemo-exec.test failures on AIX where dlopen(NULL)
	succeeds but dlsym resolves no symbol.
	* NEWS: Update.
	Report by Rainer Tammer.

	* tests/am-subdir.at: Drop unused variables.
	* tests/configure-iface.at: Likewise.
	* tests/ctor.at: Likewise.
	* tests/early-libtool.at: Likewise.
	* tests/lt_dladvise.at: Likewise.
	* tests/old-m4-iface.at: Likewise.
	* tests/lt_dlexit.at: Likewise.  Also drop unused functions.

	* tests/old-m4-iface.at (AM_PROG_LIBTOOL): Also copy needed
	lt~obsolete.m4.

	* libltdl/config/ltmain.m4sh (func_mode_link): Fix warning
	about -l and -L for archives and objects as output, to not
	trigger for *.la files.  Non-convenience archives are diagnosed
	later on.

	* tests/configure-iface.at: Ensure LTDLINCL is expanded
	before CPPFLAGS, so that even CPPFLAGS=-I/usr/local/include
	won't make the tests prefer an installed ltdl.h over the
	in-package one.
	* tests/lt_dladvise.at, tests/lt_dlexit.at: Likewise.
	* tests/need_lib_prefix.at, tests/old-m4-iface.at: Likewise.
	Report by Bob Friesenhahn.

2008-01-11  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* libltdl/m4/libtool.m4 (_LT_LINKER_SHLIBS) <exclude_expsyms>:
	Also exclude `_GLOBAL__F[ID]_.*'.  Also set for the C++ tag.
	Fixes esp. demo/helldl build failure with GCC on AIX.
	Report by Rainer Tammer.

2008-01-11  Peter O'Gorman  <peter@pogma.com>

	* libltdl/m4/libtool.m4 [darwin]: Reorganize darwin support, use
	dsymutil if it is available so that debugging is possible, check
	for nmedit and dsymutil with AC_CHECK_TOOL, use the linker flag
	-exported_symbols_list in preference to nmedit if it is available.
	Drop support for xlc, it is probably broken.
	* tests/template.at [darwin]: Skip this test, I can not find a way
	to make it work on darwin9 with Xcode-3.0.
	* NEWS: Note the dropping of xlc support.

2008-01-08  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* libltdl/m4/libtool.m4 (LT_INIT): m4_require, not AC_REQUIRE
	_LT_CHECK_BUILDDIR, as it's m4_defun'ed, not AC_DEFUN'ed.
	Report by Peter O'Gorman.

	* libltdl/m4/ltdl.m4 (_LTDL_INSTALLABLE): Restore correct
	_LT_BUILD_PREFIX-using code.

2008-01-08  Gary V. Vaughan  <gary@gnu.org>

	* tests/recursive.at: Remove bogus --debug option.
	Reported by Ralf Wildenhues <Ralf.Wildenhues@gmx.de>

	* tests/configure-iface.at: Build libltdl in a subdir so that
	it can be easily removed without trying to remove config.log
	on windows (which can't delete a file until it is closed).
	Reported by Ralf Wildenhues <Ralf.Wildenhues@gmx.de>

	* libltdl/m4/ltdl.m4 (LTDL_INSTALLABLE): Use _LT_BUILD_PREFIX
	instead of ${top_builddir} for Autoconf-2.62.
	Reported by Ralf Wildenhues <Ralf.Wildenhues@gmx.de>

	* libltdl/m4/ltdl.m4 (_LT_CONFIG_LTDL_DIR): Correct closing
	comment.
	Reported by Ralf Wildenhues <Ralf.Wildenhues@gmx.de>

	* NEWS: Grammar nit.

	* tests/configure-iface.at, tests/nonrecursive.at,
	tests/recursive.at, tests/subproject.at (_LTDL_SETUP):
	Renamed to _LT_AT_LTDL_SETUP to avoid a nameclash with
	libltdl/m4/ltoptions.m4:_LTDL_SETUP from yesterday's patch.
	Reported by Ralf Wildenhues <Ralf.Wildenhues@gmx.de>

2008-01-07  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* tests/runpath-in-lalib.at (Runpath in libtool library files):
	Compile program file without libtool.
	Report by Rainer Tammer.

2008-01-07  Rainer Tammer <tammer@tammer.net>  (tiny change)
	    Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Support AIX 6.1.
	* libltdl/m4/libtool.m4 (_LT_SYS_DYNAMIC_LINKER)
	(_LT_CHECK_MAGIC_METHOD, _LT_COMPILER_PIC, _LT_LINKER_SHLIBS)
	(_LT_LANG_C_CONFIG, _LT_LANG_CXX_CONFIG, _LT_LANG_F77_CONFIG)
	(_LT_LANG_FC_CONFIG): Adjust case patterns to match AIX 6
	through 9 as well.
	* libltdl/m4/ltdl.m4 (LT_SYS_DLOPEN_DEPLIBS): Likewise.
	* NEWS: Update.
	* THANKS: Update.

2008-01-07  Gary V. Vaughan  <gary@gnu.org>

	Move libltdl build mode options from LT_CONFIG_LTDL_DIR to
	LTDL_INIT.  Accept (optional) new 'convenience' and 'installable'
	options in lieu of LTDL_CONVENIENCE and LTDL_INSTALL macros. And
	also, implement --with-included-ltdl, --with-ltdl-lib and
	--with-ltdl-include configure-time options:

	* libltdl/m4/ltoptions.m4: Associate existing option settings with
	LT_INIT.
	(LT_OPTION_DEFINE): Associate options 'nonrecursive', 'recursive',
	'subproject', 'installable' and 'convenience' with LTDL_INIT.
	(_LT_MANGLE_OPTION, _LT_SET_OPTION, _LT_IF_OPTION)
	(_LT_UNLESS_OPTIONS, _LT_SET_OPTIONS): Add MACRO-NAME argument to
	support options to named macros instead of hardcoding only LT_INIT
	options.
	* libltdl/m4/ltdl.m4 (_LTDL_CONVENIENCE): Factor common code from
	LTDL_CONVENIENCE and LTDL_INIT([convenience]).
	(_LTDL_INSTALLABLE): Factor out common code from LTDL_INSTALLABLE
	and LTDL_INIT([installable]).
	(_LTDL_SETUP): Renamed from LTDL_INIT.  Support new configure-time
	options: --with-included-ltdl, --with-ltdl-lib,
	--with-ltdl-include.
	(LTDL_CONVENIENCE, LTDL_INSTALLABLE): Adjust.
	(LT_WITH_LTDL): Removed.
	(LTDL_INIT): Parse caller options.
	* libltdl/m4/libtool.m4 (LT_INIT): Declare that this macro must be
	expanded before LTDL_INIT, and be sure to parse caller options.
	* configure.ac: Call directly into internal _LTDL_SETUP macro.
	* libtoolize.m4sh (func_scan_files): Ltdl mode argument moved from
	LT_CONFIG_LTDL_DIR to LTDL_INIT.
	* tests/nonrecursive.at, tests/recursive.at: Use new interfaces.
	* tests/configure-iface.at: Test it.
	* Makefile.am (TESTSUITE_AT): Add configure-iface.at.
	* doc/libtool.texi (Distributing libltdl): Document improved
	LTDL_INIT interfaces.
	* NEWS: Updated.

2008-01-02  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* libltdl/config/ltmain.m4sh (func_mode_link): When creating
	reloadable object files, avoid issuing plain `rm -f' without
	further arguments, even if the line length limit is ridiculously
	low as in the `Run tests with low max_cmd_len' test.  This
	failure is exposed on NetBSD.
	Report by Patrick Welche.

	* Makefile.am (EXTRA_DIST): Add ChangeLog.2007.
	* ChangeLog.2007: New, rotated, from...
	* ChangeLog: ...here.
	* NEWS, README, README.alpha, Makefile.am, libtoolize.m4sh,
	libltdl/config/getopt.m4sh, libltdl/config/ltmain.m4sh,
	libltdl/m4/libtool.m4: Bump copyright years.

Continued in ChangeLog.2007

	$Revision$ $Date$

vim:tw=72
